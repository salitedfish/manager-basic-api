package com.ruoyi.web.controller.system;

import com.ruoyi.common.core.controller.BaseController;
import com.ruoyi.common.core.domain.AjaxResult;
import com.ruoyi.common.utils.PrinterUtils;
import com.ruoyi.common.utils.QRCodeUtils;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import org.springframework.web.bind.annotation.*;

/**
 * 调用打印机服务
 */
@Api("调用打印机服务")
@RestController
@RequestMapping("/test/printer")
public class SysPrinterController extends BaseController {

    /**
     * 打印机调用测试
     * @return
     * @throws Exception
     */
    @ApiOperation("打印机调用测试")
    @PostMapping ("/test")
    public AjaxResult printTest() throws Exception {
        String printStr = "<div data-v-e787917e=\"\" class=\"html-template\" style=\"width: 6cm; height: 4cm;\"><div data-v-e787917e=\"\" class=\"vdr inactive  template-shortUrl\" style=\"z-index: auto; top: 54px; left: 128px; position: absolute;\"><div class=\"content-container\" style=\"width: 86px; height: 86px;\"><img data-v-e787917e=\"\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFQAAABUCAYAAAAcaxDBAAADQUlEQVR4Xu3c0W4CMQxEUfj/j6b0cYPE0ciBpXQq9SmN41yP7ewGer1cLrf779t+brfny12v14Mv079f7b16o7/eF+hGygW6EeavqQJ9NVDVrHT9tCau9lUD5e90fe13tf+gUDmoBQQktV+gC9GpQgq0QI/HpjUlpZA1xTVfKS9Fy590fdlL98caunvBAl2eXNSUUoWkTUwBTteXvSp0ebSdlpA/D3Sq2CoUNSRVWIEW6HMCqULU5KrQsCkUKAhUocsLZgGRojRfB/t2+YVAgUKhUqTG06YiexrfHVCt93HvQ9NHP22wQMN3BQWKa+GvV6gUMB1PUzKtwbI/9V/zT7/13A2sQMOSIGAal8Km41XolOB6h3aP6Fs/ijP1X03s7O1cC3Qa4uP8At3L81Kgu4He7R1qqGpQesxJL7nUpXf7J3spb97LT1+nFejwE8ZpF04VL0XttleFDh8UUoAPGby7hsohKVglIrWvmix78mf8PlQpJQcLdH20Cr+loaamAKhmyn4VuhD6OqBK8WkKy74U/O715S/PoTQQXmEoBaeKVACm65OHujwNFOghhlVo2GQpsPX1HSeEDqRdWCm727/UHv0r0Odf1k2b3sPruzRi0yaye778TzOmQMOSpACMgbJGoKunx5J0Q1P72p/sa378xl4Rk0NnjwuI/NP8AsWjrgT0UJPTW08toAifPS6FyT/NjxUqg+m4AiR7u08J01NAgW6+8inQAj0m5cel/Pq2STVrOp4CSNfbfa6N1y/Q42flpk3y9I8zpgrQ31ehIhSOfxzQ3TVuukGdC8VbB3XtV/4/+LfWUC2gDQjA7g3Kn93riQ+vQOSwxhVhjStAWr9Aw4P2nwOaHiNerQgpeuqvAsT1VUOnDsoBpXQaoKm/BYr/ICFAajJxwKvQ7FtFyjh2+WkK0YHwA7KrYlKFSXGyLx4FOrx0jA/2ikga0d1NpgoN/w2RAlqg4VdLpzVYXV41VQFb/Tu9hmrDBRqmdIGCQNp0/h1QbVjjStnd86dNbDxfT0rasMYLNOzCBXokwC4vYBr/9woVoOn4tGlNa9zUfwnk9GtkOaiDtx59pwC1/oNA1qa02wFtuECHxL895X8AniST+A28urwAAAAASUVORK5CYII=\" style=\"width: 100%;\"></div> <div class=\"vdr-stick vdr-stick-tl\" style=\"width: 8px; height: 8px; top: -4px; left: -4px;\"></div><div class=\"vdr-stick vdr-stick-tm\" style=\"width: 8px; height: 8px; top: -4px; margin-left: -4px;\"></div><div class=\"vdr-stick vdr-stick-tr\" style=\"width: 8px; height: 8px; top: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-mr\" style=\"width: 8px; height: 8px; margin-top: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-br\" style=\"width: 8px; height: 8px; bottom: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-bm\" style=\"width: 8px; height: 8px; bottom: -4px; margin-left: -4px;\"></div><div class=\"vdr-stick vdr-stick-bl\" style=\"width: 8px; height: 8px; bottom: -4px; left: -4px;\"></div><div class=\"vdr-stick vdr-stick-ml\" style=\"width: 8px; height: 8px; margin-top: -4px; left: -4px;\"></div></div><div data-v-e787917e=\"\" class=\"vdr inactive  template-belongOrgName\" style=\"z-index: auto; top: 98px; left: 0px; position: absolute;\"><div class=\"content-container\" style=\"width: 63px; height: 18px;\"><p data-v-e787917e=\"\" style=\"text-align: center; line-height: 1.5em; font-size: 14px;\"> 所属组织 </p></div> <div class=\"vdr-stick vdr-stick-tl\" style=\"width: 8px; height: 8px; top: -4px; left: -4px;\"></div><div class=\"vdr-stick vdr-stick-tm\" style=\"width: 8px; height: 8px; top:  -4px; margin-left: -4px;\"></div><div class=\"vdr-stick vdr-stick-tr\" style=\"width: 8px; height: 8px; top: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-mr\" style=\"width: 8px; height: 8px; margin-top: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-br\" style=\"width: 8px; height: 8px; bottom: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-bm\" style=\"width: 8px; height: 8px; bottom: -4px; margin-left: -4px;\"></div><div class=\"vdr-stick vdr-stick-bl\" style=\"width: 8px; height: 8px; bottom: -4px; left: -4px;\"></div><div class=\"vdr-stick vdr-stick-ml\" style=\"width: 8px; height: 8px; margin-top: -4px; left: -4px;\"></div></div><div data-v-e787917e=\"\" class=\"vdr inactive  template-cardCode\" style=\"z-index: auto; top: 116px; left: 0px; position: absolute;\"><div class=\"content-container\" style=\"width: 61px; height: 18px;\"><p data-v-e787917e=\"\" style=\"text-align: center; line-height: 1.5em; font-size: 14px;\"> 卡片编码 </p></div> <div class=\"vdr-stick vdr-stick-tl\" style=\"width: 8px; height: 8px; top: -4px; left: -4px;\"></div><div class=\"vdr-stick vdr-stick-tm\" style=\"width: 8px; height: 8px; top: -4px; margin-left: -4px;\"></div><div class=\"vdr-stick vdr-stick-tr\" style=\"width: 8px; height: 8px; top: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-mr\" style=\"width: 8px; height: 8px; margin-top: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-br\" style=\"width: 8px; height: 8px; bottom: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-bm\" style=\"width: 8px; height: 8px; bottom: -4px; margin-left: -4px;\"></div><div class=\"vdr-stick vdr-stick-bl\" style=\"width: 8px; height: 8px; bottom: -4px; left: -4px;\"></div><div class=\"vdr-stick vdr-stick-ml\" style=\"width: 8px; height: 8px; margin-top: -4px; left: -4px;\"></div></div><div data-v-e787917e=\"\" class=\"vdr inactive  template-cardName\" style=\"z-index: auto; top: 58px; left: 1px; position: absolute;\"><div class=\"content-container\" style=\"width: 59px; height: 18px;\"><p data-v-e787917e=\"\" style=\"text-align: center; line-height: 1.5em; font-size: 14px;\"> 卡片名称 </p></div> <div class=\"vdr-stick vdr-stick-tl\" style=\"width: 8px; height: 8px; top: -4px; left: -4px;\"></div><div class=\"vdr-stick vdr-stick-tm\" style=\"width: 8px; height: 8px; top: -4px; margin-left: -4px;\"></div><div class=\"vdr-stick vdr-stick-tr\" style=\"width: 8px; height: 8px; top: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-mr\" style=\"width: 8px; height: 8px; margin-top: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-br\" style=\"width: 8px; height: 8px; bottom: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-bm\" style=\"width: 8px; height: 8px; bottom: -4px; margin-left: -4px;\"></div><div class=\"vdr-stick vdr-stick-bl\" style=\"width: 8px; height: 8px; bottom: -4px; left: -4px;\"></div><div class=\"vdr-stick vdr-stick-ml\" style=\"width: 8px; height: 8px; margin-top: -4px; left: -4px;\"></div></div><div data-v-e787917e=\"\" class=\"vdr inactive  template-spec\" style=\"z-index: auto; top: 77px; left: 0px; position: absolute;\"><div class=\"content-container\" style=\"width: 63px; height: 18px;\"><p data-v-e787917e=\"\" style=\"text-align: center; line-height: 1.5em; font-size: 14px;\"> 规格型号 </p></div> <div class=\"vdr-stick vdr-stick-tl\" style=\"width: 8px; height: 8px; top: -4px; left: -4px;\"></div><div class=\"vdr-stick vdr-stick-tm\" style=\"width: 8px; height: 8px; top: -4px; margin-left: -4px;\"></div><div class=\"vdr-stick vdr-stick-tr\" style=\"width: 8px; height: 8px; top: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-mr\" style=\"width: 8px; height: 8px; margin-top: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-br\" style=\"width: 8px; height: 8px; bottom: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-bm\" style=\"width: 8px; height: 8px; bottom: -4px; margin-left: -4px;\"></div><div class=\"vdr-stick vdr-stick-bl\" style=\"width: 8px; height: 8px; bottom: -4px; left: -4px;\"></div><div class=\"vdr-stick vdr-stick-ml\" style=\"width: 8px; height: 8px; margin-top: -4px; left: -4px;\"></div></div><div data-v-e787917e=\"\" class=\"vdr inactive  template-fixedAssetsCode\" style=\"z-index: auto; top: 34px; left: 0px; position: absolute;\"><div class=\"content-container\" style=\"width: 88px; height: 18px;\"><p data-v-e787917e=\"\" style=\"text-align: center; line-height: 1.5em; font-size: 14px;\"> 固定资产编码 </p></div> <div class=\"vdr-stick vdr-stick-tl\" style=\"width: 8px; height: 8px; top: -4px; left: -4px;\"></div><div class=\"vdr-stick vdr-stick-tm\" style=\"width: 8px; height: 8px; top: -4px; margin-left: -4px;\"></div><div class=\"vdr-stick vdr-stick-tr\" style=\"width: 8px; height: 8px; top: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-mr\" style=\"width: 8px; height: 8px; margin-top: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-br\" style=\"width: 8px; height: 8px; bottom: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-bm\" style=\"width: 8px; height: 8px; bottom: -4px; margin-left: -4px;\"></div><div class=\"vdr-stick vdr-stick-bl\" style=\"width: 8px; height: 8px; bottom: -4px; left: -4px;\"></div><div class=\"vdr-stick vdr-stick-ml\" style=\"width: 8px; height: 8px; margin-top: -4px; left: -4px;\"></div></div><div data-v-e787917e=\"\" class=\"vdr inactive  template-c-text1\" style=\"z-index: auto; top: 6px; left: 50px; position: absolute;\"><div class=\"content-container\" style=\"width: 122px; height: 18px;\"><p data-v-e787917e=\"\" style=\"text-align: center; line-height: 1.5em; font-size: 14px;\"> 浙江明筑资产标签 </p></div> <div class=\"vdr-stick vdr-stick-tl\" style=\"width: 8px; height: 8px; top: -4px; left: -4px;\"></div><div class=\"vdr-stick vdr-stick-tm\" style=\"width: 8px; height: 8px; top: -4px; margin-left: -4px;\"></div><div class=\"vdr-stick vdr-stick-tr\" style=\"width: 8px; height: 8px; top: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-mr\" style=\"width: 8px; height: 8px; margin-top: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-br\" style=\"width: 8px; height: 8px; bottom: -4px; right: -4px;\"></div><div class=\"vdr-stick vdr-stick-bm\" style=\"width: 8px; height: 8px; bottom: -4px; margin-left: -4px;\"></div><div class=\"vdr-stick vdr-stick-bl\" style=\"width: 8px; height: 8px; bottom: -4px; left: -4px;\"></div><div class=\"vdr-stick vdr-stick-ml\" style=\"width: 8px; height: 8px; margin-top: -4px; left: -4px;\"></div></div></div>";
//        PrinterUtils.setPrinterName("123");
        PrinterUtils.print(printStr);
//        PrinterUtils.print(genPrintHtmlStr());
        PrinterUtils.printPdf("");
        return success("打印完成");
    }


    // 构建要打印的html字符串
    public String genPrintHtmlStr () throws Exception {
//        String resStr = this.templateStr;
//        return resStr;
        return QRCodeUtils.genQRCodeBase64("123");
    }

}
